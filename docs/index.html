<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Churn Prediction Dashboard</title>

    <!-- CSS -->
    <link rel="stylesheet" href="/Churn_Prediction/assets/css/style.css" />

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <!-- ================= NAVBAR ================= -->
    <div class="navbar">
      <a href="#home">Home</a>
      <a href="#about">About</a>
      <a href="#predict">Predict</a>
      <a href="#stats">Statistics</a>
      <a href="#about-us">About Us</a>
    </div>

    <!-- ================= HOME SECTION ================= -->
    <section id="home" class="section">
      <img
        class="hero-img"
        src="/Churn_Prediction/assets/images/dashboard.png"
        alt="Dashboard Image"
      />
      <h1>Customer Churn Prediction System</h1>
      <p>AI-powered analytics to predict customer churn with precision.</p>
    </section>
    <hr />
    <hr />
    <!-- ================= ABOUT SECTION ================= -->
    <section id="about" class="section about">
      <div class="about-images">
        <div class="about-text">
          <p>
            This project is an end-to-end Machine Learning powered web
            application designed to predict customer churn and present insights
            through a modern, professional dashboard interface. It combines data
            science, backend development, and frontend design into one complete
            solution.
          </p>

          <p>
            The main goal of this system is to help businesses identify
            customers who are likely to leave (churn) and take proactive actions
            to retain them.
          </p>

          <h3>游댳 What This Project Does</h3>

          <ul>
            <li>
              Predicts whether a customer will exit a service using a trained
              Machine Learning model.
            </li>
            <li>Shows the churn probability in percentage form.</li>
            <li>Classifies customers into:</li>
            <ul>
              <li>游댮 High Risk</li>
              <li>游리 Medium Risk</li>
              <li>游릭 Low Risk</li>
            </ul>
            <li>Stores each prediction in a database.</li>
            <li>Displays real-time statistics in a single-page dashboard.</li>
            <li>Visualizes prediction trends using charts.</li>
          </ul>
        </div>
        <img
          src="/Churn_Prediction/assets/images/churn.png"
          alt="Churn Prediction"
        />
      </div>
    </section>

    <!-- ================= PREDICTION FORM ================= -->
    <section id="predict" class="section">
      <h2>Predict Customer Churn</h2>

      <form action="/predict" method="POST" id="predictionForm">
        <input
          type="number"
          name="CreditScore"
          placeholder="Credit Score"
          required
        />
        <input type="number" name="Age" placeholder="Age" required />
        <input type="number" name="Tenure" placeholder="Tenure" required />
        <input type="number" name="Balance" placeholder="Balance" required />
        <input
          type="number"
          name="Product"
          placeholder="Number of Products"
          required
        />
        <input
          type="number"
          name="EstimatedSalary"
          placeholder="Estimated Salary"
          required
        />

        <select name="Gender" required>
          <option value="">Select Gender</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
        </select>

        <select name="Country" required>
          <option value="">Select Country</option>
          <option value="France">France</option>
          <option value="Germany">Germany</option>
          <option value="Spain">Spain</option>
        </select>

        <select name="HasCrCard">
          <option value="1">Has Credit Card</option>
          <option value="0">No Credit Card</option>
        </select>

        <select name="IsActiveMember">
          <option value="1">Active Member</option>
          <option value="0">Not Active</option>
        </select>

        <button type="submit">Predict Now</button>
      </form>
    </section>

    <!-- ================= STATS SECTION ================= -->
    <section id="stats" class="section">
      <h2>Prediction Statistics</h2>

      <div class="chart-wrapper">
        <canvas id="riskChart"></canvas>
      </div>

      <!-- Latest Prediction Result -->
      <div
        class="latest-prediction"
        id="predictionResult"
        style="display: none"
      >
        <h3>Latest Prediction Result</h3>
        <div class="prediction-result">
          <div class="result-card">
            <span class="result-label">Churn Probability:</span>
            <span class="result-value" id="probabilityValue">-</span>
          </div>
          <div class="result-card" id="riskCard">
            <span class="result-label">Risk Level:</span>
            <span class="result-value" id="riskValue"> - </span>
          </div>
        </div>
      </div>

      <div class="stats-info">
        <p>Total Predictions: <span id="totalCount">0</span></p>
        <p>High Risk: <span id="highCount">0</span></p>
        <p>Medium Risk: <span id="mediumCount">0</span></p>
        <p>Low Risk: <span id="lowCount">0</span></p>
      </div>
    </section>

    <!-- ================= FOOTER ================= -->
    <footer id="about-us" class="section">
      <div class="about-us-content">
        <h2>About Us</h2>

        <p>
          This Project is done by Final Year Students of Computer Science and
          Engineering And Data Science at G Pulla Reddy Engineering College
        </p>

        <h3>Team Members</h3>
        <ul class="team-list">
          <li><strong>K Rajkumar</strong> - 229X1A32B8</li>
          <li><strong>A Eswar Prasad</strong> - 239X5A32C9</li>
          <li><strong>A Harikishan Reddy</strong> - 239X5A32D1</li>
        </ul>

        <h3>Guided By</h3>
        <p><strong>Sri. Y. Shiva Kumar</strong> - Assistant Professor</p>

        <hr />
        <p style="font-size: 0.9rem; margin-top: 20px">
          춸 2026 Churn Prediction AI Dashboard | Developed by Raj Kumar
        </p>
      </div>
    </footer>

    <!-- ================= CHART SCRIPT ================= -->
    <script>
      let chartInstance = null;

      // Handle form submission
      document
        .getElementById("predictionForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const formData = new FormData(this);
          const data = {
            CreditScore: parseFloat(formData.get("CreditScore")),
            Age: parseFloat(formData.get("Age")),
            Tenure: parseFloat(formData.get("Tenure")),
            Balance: parseFloat(formData.get("Balance")),
            Product: parseFloat(formData.get("Product")),
            EstimatedSalary: parseFloat(formData.get("EstimatedSalary")),
            Gender: formData.get("Gender"),
            Country: formData.get("Country"),
            HasCrCard: parseInt(formData.get("HasCrCard")),
            IsActiveMember: parseInt(formData.get("IsActiveMember")),
          };

          // Send to backend
          fetch("/predict", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
          })
            .then((response) => response.json())
            .then((result) => {
              document.getElementById("probabilityValue").textContent =
                result.probability + "%";

              const riskCard = document.getElementById("riskCard");
              const riskValue = document.getElementById("riskValue");

              // Remove previous classes
              riskCard.classList.remove("risk-high", "risk-medium", "risk-low");

              if (result.risk === "High") {
                riskCard.classList.add("risk-high");
                riskValue.textContent = "游댮 HIGH RISK";
              } else if (result.risk === "Medium") {
                riskCard.classList.add("risk-medium");
                riskValue.textContent = "游리 MEDIUM RISK";
              } else {
                riskCard.classList.add("risk-low");
                riskValue.textContent = "游릭 LOW RISK";
              }

              document.getElementById("predictionResult").style.display =
                "block";
              updateStats(result);

              // Scroll to stats
              document
                .getElementById("stats")
                .scrollIntoView({ behavior: "smooth" });
            })
            .catch((error) => console.error("Error:", error));
        });

      function updateStats(data) {
        document.getElementById("totalCount").textContent = data.total || 0;
        document.getElementById("highCount").textContent = data.high || 0;
        document.getElementById("mediumCount").textContent = data.medium || 0;
        document.getElementById("lowCount").textContent = data.low || 0;

        updateChart(data);
      }

      function updateChart(data) {
        const ctx = document.getElementById("riskChart").getContext("2d");

        const chartData = {
          labels: ["High Risk", "Medium Risk", "Low Risk"],
          datasets: [
            {
              label: "Churn Risk Distribution",
              data: [data.high || 0, data.medium || 0, data.low || 0],
              borderWidth: 1,
              backgroundColor: [
                "rgba(220, 38, 38, 0.7)",
                "rgba(217, 119, 6, 0.7)",
                "rgba(34, 197, 94, 0.7)",
              ],
              borderColor: [
                "rgba(220, 38, 38, 1)",
                "rgba(217, 119, 6, 1)",
                "rgba(34, 197, 94, 1)",
              ],
            },
          ],
        };

        if (chartInstance) {
          chartInstance.data = chartData;
          chartInstance.update();
        } else {
          chartInstance = new Chart(ctx, {
            type: "bar",
            data: chartData,
            options: {
              responsive: true,
              maintainAspectRatio: true,
              plugins: {
                legend: {
                  labels: {
                    color: "#e2e8f0",
                  },
                },
              },
              scales: {
                y: {
                  ticks: {
                    color: "#e2e8f0",
                  },
                  grid: {
                    color: "rgba(56, 189, 248, 0.1)",
                  },
                },
                x: {
                  ticks: {
                    color: "#e2e8f0",
                  },
                  grid: {
                    color: "rgba(56, 189, 248, 0.1)",
                  },
                },
              },
            },
          });
        }
      }

      // Initialize chart on page load
      window.addEventListener("load", function () {
        updateChart({ high: 0, medium: 0, low: 0 });
      });
    </script>
  </body>
</html>
